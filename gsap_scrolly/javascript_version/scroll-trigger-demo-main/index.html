<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.3.0/gsap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.3.0/MotionPathPlugin.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.3.0/ScrollTrigger.min.js"></script>
    <script src="https://d3js.org/d3.v5.min.js"></script>
    <link
      href="https://fonts.googleapis.com/css2?family=Ubuntu+Mono&family=Bungee&family=Nunito+Sans:ital,wght@0,400;0,700;1,400&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="main.css" />
    <title>Scrollytelling with GSAP</title>
  </head>

  
  <body>
    <div class="heading-wrapper">
      <h1 class="red stack heading-6">
        Scrollytelling with GSAP ScrollTrigger
      </h1>
    </div>


    <p>
      GSAP is a JavaScript library that makes it easy to code high-performance
      and complex animations. GSAP has a flexible interface that is easy to use
      with D3 and other common dataviz libraries. GSAP has just released a new
      plugin called ScrollTrigger that facilitates scroll-driven animations.
      ScrollTrigger can be used along with GSAP’s own animation functions, but
      you can also use it just as a scroll watcher to trigger any function (for
      example, run some D3 code) on a particular scroll interaction. This
      document showcases how you can use ScrollTrigger to power some common
      dataviz scrollytelling patterns, but the library is extremely
      full-featured and flexible, you can see more about what’s possible
      <a href="https://greensock.com/scrolltrigger" target="_blank"
        >in the docs</a
      >. Oh, and if you want to see all the scroller and trigger markers for each scroll interaction in this demo, use the menu at the top right ↗. 
    </p>

    <div id="chart-wrapper">
      <svg></svg>
    </div>

    <article id="scroll-steps">
      <section class="step" id="step-1">
        One common scrollytelling pattern is to have a chart become ‘pinned’,
        while boxes of explainer text are scrolled, like this. GSAP has a
        built-in method for pinning elements like this. This chart is pinned by
        creating a new <span class="code">ScrollTrigger</span> which triggers
        when the <span class="code">#chart-wrapper</span> element reaches the
        middle of the viewport. The trigger sets
        <span class="code">pin: true</span> to pin the trigger element (in this
        case our chart wrapper) in place until the end of the trigger, which is
        set to the bottom of the last text box.
      </section>
      <section class="step" id="step-2">
        You can then trigger GSAP animations. Here, we’re using a normal
        <span class="code">gsap.to()</span> tween to animate the
        <span class="code">cx</span> attribute of our points. To trigger the
        animation on scroll, we just add a
        <span class="code">scrollTrigger</span> object to our normal GSAP tween.
        The animation fires when the second text box (our
        <span class="code">trigger</span> ) crosses the middle of the screen,
        and reverses when you scroll backwards. Using GSAP tweens has the
        advantage that you can easily pause, restart, complete, or reverse your
        tweens using <span class="code">toggleActions</span>.
      </section>
      <section class="step" id="step-3">
        You can also just use GSAP to set the ScrollTrigger, and let D3 or
        another library handle the animation. In this case, we set up a new
        <span class="code">ScrollTrigger</span> with GSAP, and passed it
        callback functions (<span class="code">circlesToTimeline</span> and
        <span class="code">circlesToRandom</span>) which contain our custom D3
        animation code via the arguments
        <span class="code">onEnter</span> (forward animation) and
        <span class="code">onLeaveBack</span> onLeaveBack (backwards animation).
        The <span class="code">onEnter</span> callback will fire when our
        <span class="code">trigger</span> crosses the scroller start from the
        top, and onLeaveBack will fire when the
        <span class="code">trigger</span> crosses the scroller start from the
        bottom.
      </section>
      <section class="step" id="step-4">
        Also, notice how all these text boxes are transitioning from transparent
        to opaque when they enter and leave the viewport? That’s GSAP too. We
        set up a <span class="code">ScrollTrigger</span> for each box (it was
        easy with GSAP’s <span class="code">toArray</span> function and a
        <span class="code">forEach</span> loop), and used the
        <span class="code">toggleClass</span> argument to toggle an ‘active’ CSS
        class (which just adds opacity to the element) whenever the element is
        in view.
      </section>
    </article>
  </body>
  <script src="main.js"></script>
</html>
